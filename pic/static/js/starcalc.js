var m_iMode,m_strMain,m_astrFull,m_strResult="";$(function(){fnInit()});var m_iLoopMsec=25,m_iAnimePer=0;
function fnInit(){function k(){m_iMode=0;m_strMain="";m_astrFull=[]}function g(){$(".subscreen").text(m_astrFull.join(" "));$(".mainscreen").text(m_strMain);$(".calc .btn").attr("disabled",!0);-1==m_iMode?$(".acx").attr("disabled",!1):0==m_iMode||2==m_iMode?($(".num").attr("disabled",!1),$(".acx").attr("disabled",!1)):1==m_iMode?($(".num").attr("disabled",!1),$(".kgo").attr("disabled",!1),$(".acx").attr("disabled",!1)):3==m_iMode?($(".num").attr("disabled",!1),$(".eql").attr("disabled",!1),$(".acx").attr("disabled",
!1)):5==m_iMode&&($(".num").attr("disabled",!1),$(".kgo").attr("disabled",!1),$(".acx").attr("disabled",!1))}function l(c){if(0!=m_iMode&&1!=m_iMode&&2!=m_iMode&&3!=m_iMode&&5!=m_iMode)return!1;5==m_iMode&&k();if(0==m_iMode||2==m_iMode)m_strMain="",m_iMode++;m_strMain+=c;g()}function h(c){if(1!=m_iMode&&5!=m_iMode)return!1;5==m_iMode&&(m_strMain=m_astrFull[4],m_astrFull=[],m_iMode=1);m_astrFull[0]=Number(m_strMain);m_astrFull[1]=c;m_strMain="";m_iMode++;g(c)}function m(){if(3!=m_iMode)return!1;m_astrFull[2]=
Number(m_strMain);if("\u00f7"==m_astrFull[1]&&0==Number(m_astrFull[2]))return m_strMain="Error",m_astrFull[3]="\uff1d",m_astrFull[4]=m_strMain,m_iMode=-1,g(),!1;var c=!1;"\uff0b"==m_astrFull[1]?m_strResult=m_astrFull[0]+m_astrFull[2]:"\uff0d"==m_astrFull[1]?m_strResult=m_astrFull[0]-m_astrFull[2]:"\u00d7"==m_astrFull[1]?m_strResult=m_astrFull[0]*m_astrFull[2]:"\u00f7"==m_astrFull[1]&&(m_strResult=Math.round(m_astrFull[0]/m_astrFull[2]),c=0<m_astrFull[0]%m_astrFull[2]);if(1E4<m_astrFull[0]||1E4<m_astrFull[2]||
1E4<m_strResult)return m_strMain="\u6570\u304c\u591a\u3059\u304e\u307e\u3059",m_astrFull[3]="\uff1d",m_astrFull[4]="Error",m_iMode=-1,g(),!1;m_strMain="";m_astrFull[3]=c?"\u2252":"\uff1d";m_iMode=4;g();if("\u00d7"==m_astrFull[1]&&0==m_astrFull[0]&&0==m_astrFull[2])return m_strMain=m_strResult,m_astrFull[4]=Number(m_strMain),m_iMode=5,g(),!1;v()}function v(){function c(){m_iAnimePer+=.002;1<=m_iAnimePer&&(m_iAnimePer=1);var a=m_iAnimePer;if(.2>a)a=Math.sin((a-0)/.2/2*Math.PI),b=0,d[b].scale.x=a,d[b].scale.y=
a,d[b].scale.z=a,d[b].rotation.y=a*Math.PI*2;else if(.4>a)a=Math.sin((a-.2)/.2/2*Math.PI),b=1,d[b].scale.x=a,d[b].scale.y=a,d[b].scale.z=a,d[b].rotation.y=a*Math.PI*2;else if(.6>a)if(a=(a-.4)/.2,.99<a)for(var b=0;2>b;b++)d[b].scale.z=-1E4;else for(a=1-Math.sin((a/2+.5)*Math.PI),b=0;2>b;b++)d[b].scale.x=1-a,d[b].scale.y=1-a,d[b].scale.z=1-a;else if(.8>a)for(b=0;2>b;b++)d[b].scale.x=-1E4,d[b].scale.y=-1E4,d[b].scale.z=-1E4;else a=Math.sin((a-.8)/.2/2*Math.PI),b=2,d[b].scale.x=a,d[b].scale.y=a,d[b].scale.z=
a;r.render(n,u);1<=m_iAnimePer?setTimeout(h,2E3):setTimeout(c,m_iLoopMsec)}function h(){for(var a=0;a<iLayerCnt;a++)n.remove(d[a]),p[a].dispose(),t[a].dispose(),delete d[a];p.length=0;t.length=0;d.length=0;m_strMain=m_strResult;m_astrFull[4]=Number(m_strMain);m_iMode=5;g()}iLayerCnt=3;var f=[];f[0]=m_astrFull[0];f[1]=m_astrFull[2];f[2]=m_strResult;for(var k=[16711680,16777215],p=[],t=[],e=0;e<iLayerCnt;e++)p[e]=new THREE.Geometry;var d=[];for(e=0;e<iLayerCnt;e++)for(var l=Math.abs(f[e]),m=0;m<l;m++)iR=
Math.random()*q,iA=360*Math.random(),p[e].vertices.push(new THREE.Vector3(Math.cos(Math.PI/180*iA)*iR,Math.sin(Math.PI/180*iA)*iR,Math.cos(360*Math.random()/180*iA)*Math.random()*q));for(e=0;e<iLayerCnt;e++)t[e]=new THREE.PointsMaterial({size:10,color:0>f[e]?k[0]:k[1]}),d[e]=new THREE.Points(p[e],t[e]),n.add(d[e]);setTimeout(function(){for(var a=0;a<iLayerCnt;a++)d[a].scale.x=-1E4,d[a].scale.y=-1E4,d[a].scale.z=-1E4;m_iAnimePer=0;c()},500)}$(".acx").click(function(){if(-1==m_iMode||0==m_iMode||1==
m_iMode||2==m_iMode||3==m_iMode||5==m_iMode)k(),g()});$(".num").click(function(){l($(this).text())});$(".kgo").click(function(){h($(this).text())});$(".eql").click(function(){m()});$(window).keydown(function(c){if(13==c.keyCode)return!1});$(window).keyup(function(c){13==c.keyCode?m():107==c.keyCode||187==c.keyCode?h("\uff0b"):109==c.keyCode||189==c.keyCode?h("\uff0d"):106==c.keyCode||186==c.keyCode?h("\u00d7"):111==c.keyCode||191==c.keyCode?h("\u00f7"):96<=c.keyCode&&105>=c.keyCode?l(c.keyCode-96):
48<=c.keyCode&&57>=c.keyCode&&l(c.keyCode-48);return!1});k();g();var q=$(".panel").width(),f=.5*q,r=new THREE.WebGLRenderer({canvas:document.querySelector("#elmCv")});r.setPixelRatio(window.devicePixelRatio);r.setSize(q,f);var n=new THREE.Scene,u=new THREE.PerspectiveCamera(45,q/f,1,1E4);u.position.set(0,0,1E3);f=new THREE.DirectionalLight(16777215);f.position.set(1,1,2);n.add(f);r.render(n,u);$("#elmCv").show()};